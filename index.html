<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Calorie Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles that can't be replicated with Tailwind */
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .progress-fill {
            transition: width 0.5s ease-out;
        }
        
        .add-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: transform 0.2s ease;
        }
        
        .add-btn:hover {
            transform: translateY(-2px);
        }
        
        .add-btn.success {
            background: #28a745 !important;
            transform: scale(0.95);
        }
        
        .success-popup {
            animation: successPop 0.6s ease-out forwards;
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
        }
        
        @keyframes successPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }
        
        .food-item.new-item {
            animation: slideInUp 0.4s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .progress-item.updated {
            animation: progressBounce 0.4s ease-out;
        }
        
        @keyframes progressBounce {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            z-index: 1000;
            pointer-events: none;
        }
        
        .confetti-1 { background: #ff6b6b; }
        .confetti-2 { background: #4ecdc4; }
        .confetti-3 { background: #45b7d1; }
        .confetti-4 { background: #96ceb4; }
        .confetti-5 { background: #f39c12; }
        .confetti-6 { background: #e74c3c; }
        .confetti-7 { background: #9b59b6; }
        .confetti-8 { background: #2ecc71; }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .celebration-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 50px;
            border-radius: 20px;
            font-size: 2em;
            font-weight: bold;
            z-index: 1001;
            text-align: center;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4);
            animation: celebrationPop 2s ease-out;
        }
        
        @keyframes celebrationPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            20% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 1;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }
        
        input:focus {
            border-color: #667eea;
        }
    </style>
</head>
<body class="min-h-screen p-5">
    <div class="max-w-4xl mx-auto bg-white rounded-3xl p-8 shadow-2xl">
        <h1 class="text-center text-gray-800 mb-8 text-5xl font-light">My Calorie Tracker</h1>
        
        <!-- Daily Goals Progress -->
        <div class="bg-gray-50 p-5 rounded-2xl mb-8">
            <div class="text-center text-gray-600 mb-5 text-lg">Daily Progress</div>
            <div id="progress-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Progress items will be generated by JavaScript -->
            </div>
        </div>
        
        <!-- Add Food Form -->
        <div class="bg-gray-50 p-6 rounded-2xl mb-8">
            <h3 class="mb-5 text-gray-800 text-xl">Add Food</h3>
            <form id="food-form">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4 items-end">
                    <div class="flex flex-col">
                        <label for="food-name" class="font-semibold text-gray-600 mb-1 text-sm">Food Name</label>
                        <input type="text" id="food-name" placeholder="e.g., Chicken Breast" required
                               class="p-3 border-2 border-gray-200 rounded-lg text-base transition-colors focus:outline-none">
                    </div>
                    <div class="flex flex-col">
                        <label for="serving-size" class="font-semibold text-gray-600 mb-1 text-sm">Serving Size</label>
                        <input type="text" id="serving-size" placeholder="e.g., 1 cup, 100g" required
                               class="p-3 border-2 border-gray-200 rounded-lg text-base transition-colors focus:outline-none">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 mb-5">
                    <div class="flex flex-col">
                        <label for="calories" class="font-semibold text-gray-600 mb-1 text-sm">Calories</label>
                        <input type="number" id="calories" step="0.1" min="0" required
                               class="p-3 border-2 border-gray-200 rounded-lg text-base transition-colors focus:outline-none">
                    </div>
                    <div class="flex flex-col">
                        <label for="protein" class="font-semibold text-gray-600 mb-1 text-sm">Protein (g)</label>
                        <input type="number" id="protein" step="0.1" min="0" required
                               class="p-3 border-2 border-gray-200 rounded-lg text-base transition-colors focus:outline-none">
                    </div>
                    <div class="flex flex-col">
                        <label for="carbs" class="font-semibold text-gray-600 mb-1 text-sm">Carbs (g)</label>
                        <input type="number" id="carbs" step="0.1" min="0" required
                               class="p-3 border-2 border-gray-200 rounded-lg text-base transition-colors focus:outline-none">
                    </div>
                    <div class="flex flex-col">
                        <label for="fat" class="font-semibold text-gray-600 mb-1 text-sm">Fat (g)</label>
                        <input type="number" id="fat" step="0.1" min="0" required
                               class="p-3 border-2 border-gray-200 rounded-lg text-base transition-colors focus:outline-none">
                    </div>
                </div>
                
                <button type="submit" class="add-btn w-full text-white border-0 py-3 px-8 rounded-lg text-base font-semibold cursor-pointer">
                    Add Food
                </button>
            </form>
        </div>
        
        <!-- Food Log -->
        <div class="bg-gray-50 p-6 rounded-2xl mb-5">
            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-5 gap-4">
                <h3 class="text-gray-800 text-xl">Today's Food Log</h3>
                <button onclick="clearAllFood()" class="bg-red-500 hover:bg-red-600 text-white border-0 py-2 px-4 rounded text-sm cursor-pointer transition-colors">
                    Clear All
                </button>
            </div>
            <div id="food-list"></div>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION =====
        const NUTRIENTS = {
            calories: {
                label: 'Calories',
                goal: 1800,
                unit: '',
                color: '#ff6b6b'
            },
            protein: {
                label: 'Protein',
                goal: 150,
                unit: 'g',
                color: '#4ecdc4'
            },
            carbs: {
                label: 'Carbs',
                goal: 150,
                unit: 'g',
                color: '#45b7d1'
            },
            fat: {
                label: 'Fat',
                goal: 70,
                unit: 'g',
                color: '#96ceb4'
            }
        };
        
        const ANIMATION_TIMINGS = {
            SUCCESS_POPUP: 800,
            SUCCESS_POPUP_DURATION: 1200,
            PROGRESS_BOUNCE: 400,
            CELEBRATION_DURATION: 3000,
            CONFETTI_STAGGER: 20
        };
        
        const CONFETTI_CONFIG = {
            COUNT: 100,
            MIN_DURATION: 2,
            MAX_DURATION: 4,
            MIN_SIZE: 6,
            MAX_SIZE: 14,
            COLORS: ['confetti-1', 'confetti-2', 'confetti-3', 'confetti-4', 'confetti-5', 'confetti-6', 'confetti-7', 'confetti-8']
        };
        
        // ===== STATE =====
        let dailyTotals = {};
        let foodEntries = [];
        
        // ===== CACHED DOM ELEMENTS =====
        let elements = {};
        
        // ===== UTILITY FUNCTIONS =====
        const roundToOneDecimal = (num) => Math.round(num * 10) / 10;
        const calculatePercentage = (current, goal) => Math.min((current / goal) * 100, 100);
        const getTodayString = () => new Date().toDateString();
        const getRandomBetween = (min, max) => Math.random() * (max - min) + min;
        
        // ===== INITIALIZATION =====
        function initializeApp() {
            cacheElements();
            initializeTotals();
            setupEventListeners();
            loadData();
        }
        
        function cacheElements() {
            elements = {
                foodForm: document.getElementById('food-form'),
                foodList: document.getElementById('food-list'),
                progressGrid: document.getElementById('progress-grid'),
                inputs: {
                    foodName: document.getElementById('food-name'),
                    servingSize: document.getElementById('serving-size'),
                    calories: document.getElementById('calories'),
                    protein: document.getElementById('protein'),
                    carbs: document.getElementById('carbs'),
                    fat: document.getElementById('fat')
                }
            };
        }
        
        function initializeTotals() {
            dailyTotals = {};
            Object.keys(NUTRIENTS).forEach(key => {
                dailyTotals[key] = 0;
            });
        }
        
        function setupEventListeners() {
            elements.foodForm.addEventListener('submit', handleFormSubmission);
        }
        
        // ===== COMPONENT CREATION =====
        function createProgressBar(nutrientKey, nutrientData) {
            return `
                <div class="progress-item ${nutrientKey} bg-white p-4 rounded-xl text-center shadow-sm">
                    <div class="text-sm text-gray-600 mb-2">${nutrientData.label}${nutrientData.unit ? ` (${nutrientData.unit})` : ''}</div>
                    <div class="w-full h-2 bg-gray-200 rounded overflow-hidden my-2">
                        <div class="progress-fill h-full rounded" id="${nutrientKey}-progress" style="background-color: ${nutrientData.color};"></div>
                    </div>
                    <div class="text-lg font-semibold text-gray-800" id="${nutrientKey}-text">0 / ${nutrientData.goal}</div>
                </div>
            `;
        }
        
        function createFoodItemHTML(entry, isNewItem = false) {
            const newItemClass = isNewItem ? 'new-item' : '';
            return `
                <div class="food-item ${newItemClass} bg-white p-4 rounded-xl mb-3 flex flex-col sm:flex-row sm:justify-between sm:items-center shadow-sm gap-3">
                    <div class="flex-1">
                        <div class="font-semibold text-gray-800">${entry.name} (${entry.servingSize})</div>
                        <div class="text-sm text-gray-600">
                            ${roundToOneDecimal(entry.calories)} cal â€¢ 
                            ${roundToOneDecimal(entry.protein)}g protein â€¢ 
                            ${roundToOneDecimal(entry.carbs)}g carbs â€¢ 
                            ${roundToOneDecimal(entry.fat)}g fat
                        </div>
                    </div>
                    <button onclick="deleteFood(${entry.id})" class="bg-red-500 hover:bg-red-600 text-white border-0 py-1 px-3 rounded text-sm cursor-pointer transition-colors self-start sm:self-center">
                        Delete
                    </button>
                </div>
            `;
        }
        
        // ===== PROGRESS BAR MANAGEMENT =====
        function initializeProgressBars() {
            elements.progressGrid.innerHTML = Object.keys(NUTRIENTS)
                .map(key => createProgressBar(key, NUTRIENTS[key]))
                .join('');
        }
        
        function updateProgressBars() {
            const allGoalsMet = checkIfAllGoalsMet();
            
            Object.keys(NUTRIENTS).forEach(nutrientKey => {
                updateSingleProgressBar(nutrientKey);
            });
            
            if (allGoalsMet && foodEntries.length > 0) {
                triggerConfettiCelebration();
            }
        }
        
        function updateSingleProgressBar(nutrientKey) {
            const current = dailyTotals[nutrientKey];
            const goal = NUTRIENTS[nutrientKey].goal;
            const percentage = calculatePercentage(current, goal);
            
            const progressBar = document.getElementById(`${nutrientKey}-progress`);
            const progressText = document.getElementById(`${nutrientKey}-text`);
            const progressItem = document.querySelector(`.${nutrientKey}`);
            
            progressBar.style.width = percentage + '%';
            progressText.textContent = `${roundToOneDecimal(current)} / ${goal}`;
            
            addTemporaryAnimation(progressItem, 'updated', ANIMATION_TIMINGS.PROGRESS_BOUNCE);
        }
        
        function checkIfAllGoalsMet() {
            return Object.keys(NUTRIENTS).every(nutrientKey => {
                return dailyTotals[nutrientKey] >= NUTRIENTS[nutrientKey].goal;
            });
        }
        
        // ===== FOOD MANAGEMENT =====
        function handleFormSubmission(e) {
            e.preventDefault();
            const foodEntry = createFoodEntryFromForm();
            addFoodEntry(foodEntry);
            clearForm();
        }
        
        function createFoodEntryFromForm() {
            return {
                id: Date.now(),
                name: elements.inputs.foodName.value,
                servingSize: elements.inputs.servingSize.value,
                calories: parseFloat(elements.inputs.calories.value),
                protein: parseFloat(elements.inputs.protein.value),
                carbs: parseFloat(elements.inputs.carbs.value),
                fat: parseFloat(elements.inputs.fat.value)
            };
        }
        
        function addFoodEntry(foodEntry) {
            foodEntries.push(foodEntry);
            showSuccessAnimation();
            updateTotals();
            displayFoodLog();
            saveData();
        }
        
        function clearForm() {
            elements.foodForm.reset();
        }
        
        function deleteFood(id) {
            foodEntries = foodEntries.filter(entry => entry.id !== id);
            updateTotals();
            displayFoodLog();
            saveData();
        }
        
        function clearAllFood() {
            if (confirm('Are you sure you want to clear all food entries for today?')) {
                foodEntries = [];
                updateTotals();
                displayFoodLog();
                saveData();
            }
        }
        
        // ===== CALCULATIONS =====
        function updateTotals() {
            initializeTotals();
            
            foodEntries.forEach(entry => {
                Object.keys(NUTRIENTS).forEach(key => {
                    dailyTotals[key] += entry[key] || 0;
                });
            });
            
            updateProgressBars();
        }
        
        // ===== DISPLAY =====
        function displayFoodLog() {
            if (foodEntries.length === 0) {
                elements.foodList.innerHTML = '<p class="text-center text-gray-500 py-5">No food logged today</p>';
                return;
            }
            
            elements.foodList.innerHTML = foodEntries
                .map((entry, index) => createFoodItemHTML(entry, index === foodEntries.length - 1))
                .join('');
        }
        
        // ===== ANIMATIONS =====
        function showSuccessAnimation() {
            const addButton = document.querySelector('.add-btn');
            
            addButton.classList.add('success');
            addButton.textContent = 'âœ“ Added!';
            
            const successNotification = createSuccessNotification();
            document.body.appendChild(successNotification);
            
            setTimeout(() => {
                resetAddButton(addButton);
            }, ANIMATION_TIMINGS.SUCCESS_POPUP);
            
            setTimeout(() => {
                removeElementSafely(successNotification);
            }, ANIMATION_TIMINGS.SUCCESS_POPUP_DURATION);
        }
        
        function createSuccessNotification() {
            const notification = document.createElement('div');
            notification.className = 'success-popup fixed top-1/2 left-1/2 bg-green-500 text-white py-5 px-8 rounded-full text-xl font-semibold z-50';
            notification.style.transform = 'translate(-50%, -50%) scale(0)';
            notification.innerHTML = 'âœ“ Food Added!';
            return notification;
        }
        
        function resetAddButton(button) {
            button.classList.remove('success');
            button.textContent = 'Add Food';
        }
        
        function addTemporaryAnimation(element, className, duration) {
            element.classList.add(className);
            setTimeout(() => {
                element.classList.remove(className);
            }, duration);
        }
        
        // ===== CONFETTI CELEBRATION =====
        function triggerConfettiCelebration() {
            if (document.querySelector('.celebration-message')) return;
            
            const celebrationMessage = createCelebrationMessage();
            document.body.appendChild(celebrationMessage);
            createConfettiShower();
            
            setTimeout(() => {
                removeElementSafely(celebrationMessage);
            }, ANIMATION_TIMINGS.CELEBRATION_DURATION);
        }
        
        function createCelebrationMessage() {
            const message = document.createElement('div');
            message.className = 'celebration-message';
            message.innerHTML = 'ðŸŽ‰ ALL GOALS ACHIEVED! ðŸŽ‰<br><small>You crushed it today!</small>';
            return message;
        }
        
        function createConfettiShower() {
            for (let i = 0; i < CONFETTI_CONFIG.COUNT; i++) {
                setTimeout(() => {
                    createSingleConfetti();
                }, i * CONFETTI_CONFIG.STAGGER);
            }
        }
        
        function createSingleConfetti() {
            const confetti = document.createElement('div');
            const confettiProperties = getRandomConfettiProperties();
            
            applyConfettiProperties(confetti, confettiProperties);
            document.body.appendChild(confetti);
            
            scheduleConfettiCleanup(confetti, confettiProperties.duration);
        }
        
        function getRandomConfettiProperties() {
            const duration = getRandomBetween(CONFETTI_CONFIG.MIN_DURATION, CONFETTI_CONFIG.MAX_DURATION);
            const size = getRandomBetween(CONFETTI_CONFIG.MIN_SIZE, CONFETTI_CONFIG.MAX_SIZE);
            const colorClass = CONFETTI_CONFIG.COLORS[Math.floor(Math.random() * CONFETTI_CONFIG.COLORS.length)];
            
            return {
                duration,
                size,
                colorClass,
                left: Math.random() * 100 + '%',
                borderRadius: Math.random() > 0.5 ? '50%' : '0%'
            };
        }
        
        function applyConfettiProperties(confetti, properties) {
            confetti.className = `confetti ${properties.colorClass}`;
            confetti.style.left = properties.left;
            confetti.style.top = '-10px';
            confetti.style.width = properties.size + 'px';
            confetti.style.height = properties.size + 'px';
            confetti.style.borderRadius = properties.borderRadius;
            confetti.style.animationDuration = properties.duration + 's';
            confetti.style.animationName = 'confetti-fall';
            confetti.style.animationTimingFunction = 'linear';
        }
        
        function scheduleConfettiCleanup(confetti, duration) {
            setTimeout(() => {
                removeElementSafely(confetti);
            }, duration * 1000);
        }
        
        // ===== DATA PERSISTENCE =====
        function saveData() {
            try {
                const data = {
                    date: getTodayString(),
                    entries: foodEntries,
                    totals: dailyTotals
                };
                localStorage.setItem('calorieTracker', JSON.stringify(data));
            } catch (e) {
                console.log('Data saving disabled in this environment - will work when hosted!');
            }
        }
        
        function loadData() {
            try {
                const saved = localStorage.getItem('calorieTracker');
                const today = getTodayString();
                
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data.date === today) {
                        loadSavedData(data);
                    } else {
                        resetToNewDay();
                    }
                } else {
                    resetToNewDay();
                }
            } catch (e) {
                resetToNewDay();
            }
            
            initializeProgressBars();
            updateProgressBars();
            displayFoodLog();
        }
        
        function loadSavedData(data) {
            foodEntries = data.entries || [];
            dailyTotals = data.totals || {};
            ensureAllNutrientsHaveValues();
        }
        
        function resetToNewDay() {
            foodEntries = [];
            initializeTotals();
        }
        
        function ensureAllNutrientsHaveValues() {
            Object.keys(NUTRIENTS).forEach(key => {
                if (dailyTotals[key] === undefined) {
                    dailyTotals[key] = 0;
                }
            });
        }
        
        // ===== UTILITY =====
        function removeElementSafely(element) {
            if (document.body.contains(element)) {
                document.body.removeChild(element);
            }
        }
        
        // ===== APP START =====
        initializeApp();
    </script>
</body>
</html>